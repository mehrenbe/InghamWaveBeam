#maple -q classic_ingham.maple
#eps=0.01 without M=Transpose(Q).M.Q, Digits=20 
#1 2.01 2.01
#2 0.00033392968630082221443 4.0196660703136991775
#3 0.00023647207402497500417 4.0200599191711843913
#4 0.00021237457140538334526 4.0202857323249689697
#5 0.00020190966886137513096 4.0204666193371213296
#10 0.00018736417326621080620 4.0211959158920332408
#25 0.00018283740874092757123 4.0231708673834622514
#50 0.00018255786320327633160 4.0267118384949452080
#100 0.00018223577705480702545 4.0349418035467255130

#eps=0.01 with M=Transpose(Q).M.Q, Digits=20 
#2 0.30855004389275730311, 4.4077773367116775411
#3 0.21392561482793792270, 4.5028902195136671451
#4 0.19121036937472212137, 4.5267004239216412408
#5  0.18143966809474316330, 4.5374893512818935583
#10 0.16800947352333156299, 4.5547435262000441429
#25 0.16396376746385857049 4.5653541087078825881
#50 0.16374455039474568409 4.5719200647066622952

#eps=1e-6 with M=Transpose(Q).M.Q, Digits=20 
#2 0.30855352633780186758, 4.4083134736621981325
#3 0.21199319370557890241 4.5049487850667418474
#4 0.18904804573535849874 4.5288479532907889364
#5 0.17920871438801187722, 4.5396212958204138143
#10 0.16570954218855087865 4.5567348112515290057
#25 0.16163910683787515074, 4.5671190049879181766
#50 0.16141555288914256466 4.5734750097008682086

#eps=1e-6 without M=Transpose(Q).M.Q, Digits=20 
#2 0.33835838308460559363E-12 4.0199999999996616416
#3 0.23756385844622794396E-12 4.0200994957122477408
#4 0.21287948789744831393E-12 4.0201999483963786339
#5 0.20219237358559791725E-12 4.0203013576782211847
#10 0.18736640094862554544E-12 4.0208226692621189119
#25 0.18275139447361483197E-12 4.0225258056464987839
#50 0.18246215730876116153E-12 4.0257949827488104934

with(LinearAlgebra):
Digits:=20:
num:=10:
eps:=1e-6:
for i to num do
	Z[i]:=evalf(Pi*i):
	#Z[i]:=2.198033577280316*i:
	#Z[i]:=2.198033577280316*i:
od:
#Z[1]:=evalf(Z[2]-eps):
T:=2.01:
T:=1.9:
M:=Matrix(num,num,0):
for i to num do
	for j to num do
		M[i,j]:= evalf(int(exp(I*(Z[i]-Z[j])*t),t=0..T)):
	od:
	val[i]:=abs(M[i,i])-add(abs(M[i,j]),j=1..i-1)-add(abs(M[i,j]),j=i+1..num);
od:
M;
Q:=Matrix(IdentityMatrix(num)):
Q[1,1]:=1.:
Q[1,2]:=-1./(Z[2]-Z[1]):
Q[2,2]:=1./(Z[2]-Z[1]):
#M:=Transpose(Q).M.Q:
M:=Matrix([seq([seq(M[i,j],j=1..num)],i=1..num)]):

Lambda:=evalf(Eigenvalues(M)):
Lambda:=[seq(evalf(abs(Lambda[i])),i=1..num)];
min(Lambda),max(Lambda);
seq(val[j],j=1..num);
